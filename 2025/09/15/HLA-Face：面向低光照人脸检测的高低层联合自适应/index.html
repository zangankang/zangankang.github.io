
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>HLA-Face：面向低光照人脸检测的高低层联合自适应 | NWPU-ZAK</title>
    <meta name="author" content="Zang Ankang" />
    <meta name="description" content="兄弟们，一定要出人头地啊" />
    <meta name="keywords" content="" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <link rel="icon" href="/images/avatar.jpg" />
    <link rel="preconnect" href="https://s4.zstatic.net" />
<script src="https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.googleapis.cn" />
<link rel="preconnect" href="https://fonts.gstatic.cn" crossorigin />
<link
    rel="stylesheet"
    href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"
/>
<script> const mixins = {}; </script>

<script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script>


<script src="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>


<script src="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/katex.min.css" />
<script src="/js/lib/math.js"></script>


<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />

  <meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>
  <body>
    <canvas
      id="fireworks"
      style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        pointer-events: none;
        z-index: 32767;
      "
    ></canvas>
    <canvas
      id="background"
      style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        pointer-events: none;
        z-index: -1;
      "
    ></canvas>
    <div id="cursor"></div>
    <div id="layout">
      <transition name="fade">
        <!-- <div id="loading" v-show="loading">
          <div id="loading-circle">
            <h2>LOADING</h2>
            <p>加载过慢请开启缓存 浏览器默认开启</p>
            <img src="/" />
          </div>
        </div> -->
        <div id="loading" v-show="loading">
          <div id="loading-circle">
            <video autoplay muted loop playsinline class="loading-video-circle">
              <source
                src="/videos/loading.mp4"
                type="video/mp4"
              />
            </video>
          </div>
        </div>
      </transition>
      <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>NWPU-ZAK</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;NWPU-ZAK</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

      <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
        <div class="article">
    <div>
        <h1>HLA-Face：面向低光照人脸检测的高低层联合自适应</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2025/9/15
        </span>
        
        
    </div>
    
    <div class="content" v-pre>
        <h4 id="hla-face面向低光照人脸检测的高低层联合自适应">HLA-Face：面向低光照人脸检测的高低层联合自适应</h4>
<span id="more"></span>
<p>本文任务是，如何充分利用现有的正常光数据，如何将在正常光照数据上训练的人脸检测器适配到未标注的弱光照图像数据中。</p>
<h4 id="问题">问题</h4>
<p>这项任务的挑战在于：</p>
<p>一、正常光照数据和低光数据之间有着像素级和目标级的大且复杂的差距：</p>
<figure>
<img src="/images/image-20250915153044156.png" alt="image-20250915153044156">
<figcaption aria-hidden="true">image-20250915153044156</figcaption>
</figure>
<p>1、一个是像素级外观的差距，指的是同一张图，变亮和变暗的区别。比如亮度不足、相机噪声、颜色偏置等。这可以通过图像增强技术在一定程度上缓解。</p>
<p>2、另一个是正常和低光场景之间的物体级语义差异，指的是两张图<strong>内容本身就不同</strong>。低光照场景（如夜晚街道）<strong>多了很多正常光照下不存在或不显著的物体（路灯、车灯）</strong>，这些物体是低光照环境所特有的、主动发光的光源。<strong>一个在白天训练的模型，可能从未“学习”过这些发光物体是什么</strong>，以及它们对周围环境（如人脸）会产生什么样的光照影响。<strong>它们会产生强烈的高光、不均匀的阴影、甚至改变人脸的颜色，这与正常光照下的情况完全不同</strong>。因此，正常光和低光场景之间的差异，<strong>不仅仅是把图片调暗了那么简单</strong>，而是整个场景的<strong>“内容和逻辑”都发生了改变</strong>。<strong>模型需要理解这种由特定物体（光源）带来的全新光照逻辑</strong>。这是图像增强方法无法解决的，它无法“无中生有”地创造出这些物体及其产生的光照效果。</p>
<p>虽然特征自适应方法试图考虑这两方面差距，但是效果有限。</p>
<p>二、数据不足，并且目前很多低光照图像目标检测都需要依赖标签，限制了灵活性和鲁棒性。</p>
<h4 id="创新">创新</h4>
<p>为了能够应对上面所说的两种数据之间的像素级和目标级的差距，作者提出了一种联合低级和高级特征自适应的方案。</p>
<p>在低光照图像和正常光照图像之间设置中间状态，并基于这些状态自适应相应的高级表示<strong>（意思是下面说的还可以自适应的减小高级距离）。</strong></p>
<figure>
<img src="/images/image-20250915153338229.png" alt="image-20250915153338229">
<figcaption aria-hidden="true">image-20250915153338229</figcaption>
</figure>
<p>1、低级特征适应，设计了双向方案，<strong>通过增强低光数据和变暗正常光数据来创建中间状态减小低级距离</strong>，与L-to-H或H-to-L单向平移相比，<strong>双向平移：L-to-E(L)和H-to-D(H)，不仅可以缓解自适应的难度，还可以</strong>为特征级自适应提供更多的工具，<strong>通过将多个状态的特征空间推向彼此来减小高级距离。</strong></p>
<p>2、高级特征适应，基于构建的中间状态，引入了<strong>跨领域自监督学习进行特征适应</strong>。<strong>通过基于上下文的对比学习，全面地缩小了多个域之间的特征距离</strong>，进一步增强表示。</p>
<h4 id="具体来说">具体来说</h4>
<figure>
<img src="/images/image-20250915154057404.png" alt="image-20250915154057404">
<figcaption aria-hidden="true">image-20250915154057404</figcaption>
</figure>
<h4 id="双向低级自适应">双向低级自适应</h4>
<ul>
<li><p>低层自适应（像素层面的调整）的挑战在于两个方面。</p>
<ol type="1">
<li><p><strong>正常与低光场景之间还同时存在着高层语义上的差异</strong>（不仅是亮度不同这种底层差异，还有场景内容层面/语义层面的差异，就像我们前面说的，<strong>低光场景中多了路灯、车灯、广告牌这些内容，而正常光照场景中没有</strong>）。<strong>这种内容上的差异会干扰那些只做像素级转换的模型</strong>（如CycleGAN、CUT等），把本属于夜晚场景的物体（如路灯）错误地添加到转换后的图像中，导致生成结果不伦不类。</p>
<figure>
<img src="/images/image-20250915155518421.png" alt="image-20250915155518421">
<figcaption aria-hidden="true">image-20250915155518421</figcaption>
</figure>
<p>模型在学习“夜晚风格”时，发现DARK
FACE数据集里很多图片都带有<strong>路灯、车灯等发光体</strong>。于是模型<strong>错误地认为“路灯”也是“夜晚风格”的一部分</strong>。当模型处理一张白天的人脸时，它<strong>不仅会把图片调暗，还会“无中生有”地在人脸上画一个路灯，或者在人的身体上生成奇怪的光斑。</strong></p></li>
<li><p><strong>弱光增强本身的难度</strong>。现有的一些低照度增强方法都是按照人类视觉的方式进行增强，不是考虑机器视觉。现在的一些方法画出了暗区域的边缘，有噪声的部分还是黑的，增强的对比度可能会影响检测性能。此外，DARK
FACE中的图像有密集的噪声和颜色偏差，而现有的去噪和颜色重构方法不足以解决这些问题</p></li>
</ol></li>
<li><p>解决方法。</p>
<ul>
<li><p>作者提出了双向低级适应方案，将正常光照图像退化为弱光图像是一个复杂的过程，可以分解成三个因素：光照、噪声、颜色偏差。</p>
<p>把一张<strong>正常光图像H，人为地加上噪声和颜色偏差，变成一张“伪低光”照片D(H)。</strong></p>
<p>把一张<strong>真实低光照片 L，用算法提亮，变成一张“伪正常光”照片
E(L)。</strong></p>
<p>与L和H相比，E(L)和D(H)更相似。<strong>现在模型要学习的转换就变成了从
H -&gt; E(L) 和 D(H) -&gt;
L</strong>。这两个任务中的图像<strong>内容是相似的</strong>，<strong>不再有“路灯”这种语义上的巨大差异。模型只需要专注于处理亮度、噪声、颜色这些“要素”级别的变化就行了。</strong></p></li>
</ul></li>
</ul>
<ol type="1">
<li><p>Brightening</p>
<ul>
<li><p>调整亮度的同时不会让图像产生噪声和色偏(调整亮度后不需要额外再去噪和颜色重构)，而且<strong>弱光图像存在光照不均匀的问题，有些人脸可能会被路灯提亮，而有些则可能会被严重的黑暗覆盖</strong>，因此我们还需要<strong>防止曝光过度和曝光不足</strong>。</p>
<hr>
<p>(1)、如果使用简单的线性提亮方法，比如把整张图片所有像素的亮度值都乘以2。那么<strong>对于黑暗区域</strong>：一个亮度为20的像素点，乘以2后变成40，确实变亮了，效果不错。<strong>而对于已被路灯照亮的区域：一个亮度已经是150的像素点，乘以2后变成300。但在标准的图像格式中，亮度最大值是255。所以这个点就会变成255，即“纯白色”，完全失去了细节。这就是曝光过度
(over-exposure)</strong>。</p>
<p><strong>线性方法就像一个“一刀切”的政策，它无法同时照顾到暗部和亮部的不同需求，必然会导致一部分区域效果好，另一部分区域效果差（甚至更差）。</strong></p>
<p>(2)、非线性曲线映射就好比一个<strong>“精细化调节”</strong>的工具。<strong>能够对图像中不同亮度的区域做不同程度的调整，这恰好是解决“光照不均匀”问题的最理想工具。</strong></p>
<p>面对“光照不均匀”的人脸，非线性曲线可以<strong>大幅提亮暗部
(防止曝光不足)</strong>：对于输入亮度很低（比如0-50）的像素，我们可以让曲线变得非常<strong>“陡峭”</strong>。这意味着，一个微小的亮度变化（比如从20提升到21）会被映射成一个巨大的输出变化（比如从40提升到60）。这样就把黑暗中的细节给“拉”了出来。</p>
<p>也可以<strong>轻微调整甚至压缩亮部
(防止曝光过度)</strong>：对于输入亮度已经很高（比如200-255）的像素，我们可以让曲线变得非常<strong>“平缓”</strong>。这意味着，即使输入亮度有变化，输出亮度也只会有微小的改变，或者干脆都映射到一个比较高的值（但不是纯白的255）。这样就保住了高光区域的细节，防止其变成一片死白。</p>
<hr>
<p>所以使用了基于<strong>非线性曲线映射</strong>方法，由迭代二次曲线<span class="math display"><em>L</em><em>E</em>(⋅)</span>构成：</p>
<p><span class="math display"><em>L</em><em>E</em>(<em>x</em>, <em>A</em>) = <em>x</em> + <em>A</em><em>x</em>(1 − <em>x</em>),</span></p>
<p><span class="math display"><em>L</em><em>E</em><sub><em>n</em></sub> = <em>L</em><em>E</em>(<em>L</em><em>E</em><sub><em>n</em> − 1</sub>; <em>A</em><sub><em>n</em></sub>),</span></p>
<p><span class="math display"><em>L</em><em>E</em><sub>0</sub></span>是输入图像，<span class="math display"><em>L</em><em>E</em><sub><em>n</em></sub></span>是迭代n次的结果。<span class="math display"><em>A</em><sub><em>n</em></sub></span>​是由神经网络预测出的像素级三通道调整图。与常见的端到端或基于Retinex的深度增强方法相比，曲线映射不会引入额外的噪声或伪影。使用了一个7层具有对称Skip-connection的CNN和相应的目标函数。</p></li>
<li><p>如果增强太多会带来更多的噪声，如果只进行一个弱增强的话，噪声就会隐藏在黑暗中，成像质量更好，但是弱增强会导致许多人脸仍然被黑暗覆盖。所以作者提出<strong>强增强</strong>。将上述公式中的迭代次数加倍，并扩大曲线估计网络，<strong>模型可以以更高的亮度增强图像。缺点是随之而来的噪声和颜色偏差</strong>，但在下面的H
-&gt; D(H) 过程中会处理。</p></li>
</ul></li>
<li><p>噪声合成。</p>
<ul>
<li><p>虽然像素级距离可以通过调整亮度来缩小，但减少E(L)和H之间的差距仍然比较困难。因此，我们进一步将剩余的差距分解为<strong>颜色和噪声</strong>。</p></li>
<li><p>噪声和颜色相关，噪声本身就是带颜色的，通常是红、绿、蓝的杂色斑点。并且由于感光元件（CMOS/CCD）对不同颜色的光（红、绿、蓝）敏感度不同，经过相机内部处理后，不同颜色通道的噪声强度也不同。例如，蓝色通道通常是噪声最大的。在一张照片里，深蓝色区域的噪声模式，和亮黄色区域的噪声模式是完全不一样的。</p></li>
<li><p>所以，可以先分析和计算出从正常光图像H到提亮后的低光图像E(L)之间，还存在哪些<strong>颜色上的差异</strong>。这一步等于得到了一个<strong>”颜色校正图“或者说“颜色指导图”。</strong></p>
<p>然后<strong>用颜色引导噪声合成</strong>，在生成噪声往图H上添加的时候，他们不是盲目地添加，而是参考上一步得到的“颜色指导图”。这个过程可以理解为一个生成模型，它的输入不仅是原始图像，还包括了目标颜色信息。</p>
<p>所以为了让合成的噪声尽可能逼真，我们不能把它当成一个孤立的过程。我们应该<strong>先搞清楚目标图像的“颜色特征”，然后利用这些特征作为“先验知识”或“条件”，去指导一个可控的噪声生成过程。</strong>这样做避免了“一刀切”式地添加不真实的均匀噪声，而是为图像的每一个不同颜色、不同亮度的区域“量身定制”了最合适的噪声，从而让最终模拟出的低光图像D(H)在细节上更接近真实的低光图像L。</p></li>
<li><p>首先通过<span class="math display"><em>d</em> = 25</span>和<span class="math display"><em>σ</em> = 75</span>的强双边滤波器模糊E(L)。模糊后的结果<span class="math display"><em>E</em>(<em>L</em>)<sub><em>b</em><em>l</em><em>u</em><em>r</em></sub></span>作为颜色引导噪声合成。然后，训练一个Pix2Pix将模糊后的结果<span class="math display"><em>E</em>(<em>L</em>)<sub><em>b</em><em>l</em><em>u</em><em>r</em></sub></span>转移到所需要的E(L)。最后，我们以同样的方式模糊H，并使用训练好的Pix2Pix添加噪声。最终得到的<span class="math display"><em>H</em><sub><em>n</em><em>o</em><em>i</em><em>s</em><em>e</em></sub></span>成功地模仿了E(L)的噪声模式。它们在颜色分布上的差异将在下一步处理。</p></li>
</ul></li>
<li><p>颜色抖动(修正)：</p>
<ul>
<li><span class="math display"><em>D</em>(<em>H</em>)</span>的颜色分布要匹配<span class="math display"><em>E</em>(<em>L</em>)</span>，基于统计学分析，设置了亮度抖动区间(0.4,
1.2)，对比度抖动区间(0.6, 1.4)，饱和度抖动区间(0.6,
1.4)，色度抖动区间(0.8, 1.2)。</li>
</ul></li>
</ol>
<h4 id="多任务高级适应">多任务高级适应</h4>
<p>大多数特征自适应方法基于图像对齐、伪标签训练和对抗学习，但是图像对齐和伪标签训练不能处理巨大的差距，而对抗性学习并不稳定，我们转而<strong>充分利用图像本身的自然信息</strong>，即自监督学习，<strong>通过强制自监督学习分类器跨域共享，强制将特征映射到相同的高维子空间，从而缩小高层差距。</strong></p>
<hr>
<p>解释一下这句话的意思：</p>
<p>通过强迫模型用<strong>同一个‘大脑’</strong>（即共享的分类器）去理解<strong>来自不同领域（正常光和低光）的图像</strong>，我们也就强迫模型必须学会用一种<strong>通用语言</strong>（<strong>即相同的特征子空间，也就是上面说的强制将特征映射到相同的高维子空间</strong>）来描述这些图像，这样一来，不同领域之间的<strong>理解障碍（高层语义鸿沟）</strong>就被消除了。</p>
<p>举个例子：</p>
<p><strong>两个领域
(Domains)</strong>：一个只说中文的人（正常光图像），一个只说英文的人（低光照图像）。</p>
<p><strong>特征
(Features)</strong>：每个人脑中对“苹果”这个概念的内部表述。</p>
<p><strong>高层语义鸿沟 (High-level
gap)</strong>：两个人无法直接交流，因为他们对“苹果”的表述（语言）不同。</p>
<p><strong>自监督学习分类器 (Self-supervised learning
classifier)</strong>：一个翻译老师。</p>
<p><strong>共享分类器 (Shared
classifier)</strong>：我们<strong>只聘请一位既懂中文又懂英文的翻译老师</strong>，而不是请一个中翻英和一个英翻中老师。</p>
<p><strong>相同的特征子空间 (Same high dimensional
subspace)</strong>：这位翻译老师为了完成工作，在自己脑中形成的一个<strong>不依赖于具体语言的、对“苹果”这个物体的抽象概念</strong>。</p>
<p>自监督学习是一种让模型自己给自己出题来学习的方法。比如，把一张图片随机旋转0°、90°、180°或270°，然后让模型去预测这张图被旋转了多少度。为了能正确完成这个任务，模型必须先“看懂”图片的内容（比如它得先认识到人脸是正的还是倒的）。这个“预测旋转角度”的模块就是<strong>自监督学习分类器</strong>。</p>
<p>共享就是作者用<strong>同一个旋转角度预测器</strong>，去分别处理正常光图像和低光照图像。无论是给它一张亮的脸，还是一张暗的脸，都让这<strong>同一个分类器</strong>去判断旋转了多少度。</p>
<p><strong>高维子空间 (High dimensional
subspace)</strong>：可以把它理解为模型用来表达这些特征的“数学语言”或“表示空间”。</p>
<p>因为只有一个分类器，它要能同时处理正常光和低光两种图像，它就必须学会提取一种<strong>通用的、不受光照影响的特征。</strong>模型为了让这同一个分类器能正常工作，就会被迫学习去忽略“亮度”、“噪声”这些属于不同领域的干扰信息，而专注于提取这种最本质的语义特征。最终结果就是，一张亮的人脸和一张暗的人脸，<strong>在模型内部都会被用非常相似的“数学语言”（即映射到特征空间中的邻近位置）来表达。</strong></p>
<p>一张正常光人脸的特征和一张低光照人脸的特征，在模型看来变得非常相似了。这样一来，一个在正常光数据上训练好的人脸检测器，拿到低光照图像的特征后也能认识并处理了，因为特征的“语言”已经被统一了。鸿沟自然就被填补了。</p>
<p>这是一种非常巧妙的“特征对齐”方法。它不直接去修改图像像素，而是在特征层面，通过设计一个“共享”的自监督任务，<strong>强迫模型自己去学习一种不受领域（光照）变化影响的、更本质、更通用的特征表达方式</strong>，从而解决了正常光和低光照两个领域之间的语义差异问题。</p>
<hr>
<p>为了实现：无论输入给模型的是一张<strong>干净的正常光图像
(H)</strong>，一张<strong>被提亮了的低光图像
(E(L))</strong>，还是一张<strong>被人工模拟成低光的正常光图像
(D(H))</strong>，只要它们的内容（比如里面的人脸）是相同的，模型最终输出的特征向量就应该非常接近。</p>
<p>首先通过跨域的、基于上下文的自监督学习来搭建H与E(L)之间的桥梁，让模型学习到，一张提亮后的低光图像E(L)和一张干净的正常光图像H，虽然一个有噪点和色偏，一个没有，但它们的<strong>核心内容和结构是相同的</strong>。这一步强迫模型学会<strong>忽略真实的噪声和色偏</strong>。</p>
<p>然后通过跨域对比学习来搭建H与D(H)之间的桥梁，让模型学习到，一张干净的正常光图像H和我们<strong>亲手把它变脏的图像D(H)是一对正样本</strong>。<strong>因为D(H)是由H直接生成的，内容完全一致，所以这是一个非常强的监督信号。这一步强迫模型学会忽略我们模拟的噪声和色偏。</strong></p>
<h4 id="搭建h与el之间的桥梁">搭建H与E(L)之间的桥梁</h4>
<p>基于上下文的<strong>自监督学习设计代理任务</strong>（我们的<strong>真正目的</strong>并不是让模型去完成这个任务本身，而是希望模型<strong>在完成这个任务的过程中，能学到一些通用的、有价值的图像特征</strong>），通过这些任务模型可以<strong>学习理解物体的空间上下文</strong>。在这里，作者<strong>使用拼图方法</strong>（效果最好）。<strong>将3×3的补丁组装成一个完整的图像，并将补丁排列数设置为30，即30分类问题</strong>。</p>
<p><span class="math display"><em>L</em><sub><em>j</em><em>i</em><em>g</em></sub><sup><em>E</em>(<em>L</em>)</sup> = <em>C</em><sub><em>c</em></sub>(<em>F</em><sub><em>j</em><em>i</em><em>g</em></sub><sup><em>E</em>(<em>L</em>)</sup>, <em>p</em><sub><em>j</em><em>i</em><em>g</em></sub><sup><em>E</em>(<em>L</em>)</sup>),</span></p>
<p><span class="math display"><em>C</em><sub><em>j</em><em>i</em><em>g</em></sub><sup><em>H</em></sup> = <em>C</em><sub><em>c</em></sub>(<em>F</em><sub><em>j</em><em>i</em><em>g</em></sub><sup><em>H</em></sup>, <em>p</em><sub><em>j</em><em>i</em><em>g</em></sub><sup><em>H</em></sup>),</span></p>
<p><span class="math display"><em>p</em><sub><em>j</em><em>i</em><em>g</em></sub></span>表示排列的标签，<span class="math display"><em>L</em><sub><em>c</em></sub></span>为交叉熵损失。<span class="math display"><em>F</em><sub><em>j</em><em>i</em><em>g</em></sub></span>表示相应域中提取出来的特征（写在这个变量右上方的字母表示
<strong>是在对应域下的值</strong>）。</p>
<p>E(L)和H共享一个 <strong>强制把语义特征映射到相同空间</strong>
的分类头，因此使得高级特征之间的差距减少，最终损失函数:</p>
<p><span class="math display"><em>L</em><sub><em>E</em>(<em>L</em>) ↔︎ <em>H</em></sub> = <em>L</em><sub><em>j</em><em>i</em><em>g</em></sub><sup><em>E</em>(<em>L</em>)</sup> + <em>L</em><sub><em>j</em><em>i</em><em>g</em></sub><sup><em>H</em></sup>.</span></p>
<h4 id="搭建h与dh之间的桥梁">搭建H与D(H)之间的桥梁</h4>
<p>对比学习的想法是，给定一个查询v，判断这个v是“正样本对<span class="math display"><em>v</em><sup>+</sup></span>”还是“负样本对<span class="math display"><em>v</em><sup>−</sup> = <em>v</em><sub>1</sub><sup>−</sup>, <em>v</em><sub>2</sub><sup>−</sup>⋯, <em>v</em><sub><em>N</em></sub><sup>−</sup></span>”。<strong>通过点积的方法测量相似性</strong>，目标函数<span class="math display"><em>L</em><sub><em>q</em></sub>(<em>v</em>, <em>v</em><sup>+</sup>, <em>v</em><sup>−</sup>)</span>是：</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -2.858ex;" xmlns="http://www.w3.org/2000/svg" width="39.244ex" height="6.816ex" role="img" focusable="false" viewbox="0 -1749.5 17345.8 3012.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"/></g><g data-mml-node="TeXAtom" transform="translate(714,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"/></g></g></g><g data-mml-node="mo" transform="translate(1367,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mo" transform="translate(2422.8,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mi" transform="translate(3367.5,0)"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(278,0)"/><path data-c="67" d="M329 409Q373 453 429 453Q459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390Q410 404 415 411Q415 412 416 414V415Q388 412 363 393Q355 388 355 386Q355 385 359 381T368 369T379 351T388 325T392 292Q392 230 343 187T222 143Q172 143 123 171Q112 153 112 133Q112 98 138 81Q147 75 155 75T227 73Q311 72 335 67Q396 58 431 26Q470 -13 470 -72Q470 -139 392 -175Q332 -206 250 -206Q167 -206 107 -175Q29 -140 29 -75Q29 -39 50 -15T92 18L103 24Q67 55 67 108Q67 155 96 193Q52 237 52 292Q52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292Q142 248 149 227T179 192Q196 182 222 182Q244 182 260 189T283 207T294 227T299 242Q302 258 302 292T299 343ZM403 -75Q403 -50 389 -34T348 -11T299 -2T245 0H218Q151 0 138 -6Q118 -15 107 -34T95 -74Q95 -84 101 -97T122 -127T170 -155T250 -167Q319 -167 361 -139T403 -75Z" transform="translate(778,0)"/></g><g data-mml-node="mo" transform="translate(4645.5,0)"><path data-c="2061" d=""/></g><g data-mml-node="mrow" transform="translate(4812.2,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="5B" d="M269 -1249V1750H577V1677H342V-1176H577V-1249H269Z"/></g><g data-mml-node="mfrac" transform="translate(583,0)"><g data-mml-node="mrow" transform="translate(3846.4,710)"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"/></g><g data-mml-node="mo" transform="translate(571,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(960,0)"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"/></g><g data-mml-node="mo" transform="translate(1445,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"/></g><g data-mml-node="msup" transform="translate(1889.7,0)"><g data-mml-node="mi"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"/></g><g data-mml-node="TeXAtom" transform="translate(518,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"/></g></g></g><g data-mml-node="mo" transform="translate(3007.8,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g></g><g data-mml-node="mrow" transform="translate(220,-920)"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"/></g><g data-mml-node="mo" transform="translate(571,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(960,0)"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"/></g><g data-mml-node="mo" transform="translate(1445,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"/></g><g data-mml-node="msup" transform="translate(1889.7,0)"><g data-mml-node="mi"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"/></g><g data-mml-node="TeXAtom" transform="translate(518,289) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"/></g></g></g><g data-mml-node="mo" transform="translate(3007.8,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(3619,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"/></g><g data-mml-node="munderover" transform="translate(4619.2,0)"><g data-mml-node="mo"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"/></g><g data-mml-node="TeXAtom" transform="translate(1089,477.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"/></g></g><g data-mml-node="TeXAtom" transform="translate(1089,-285.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(600,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mn" transform="translate(1378,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g></g></g><g data-mml-node="mi" transform="translate(7252.9,0)"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"/></g><g data-mml-node="mo" transform="translate(7823.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(8212.9,0)"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"/></g><g data-mml-node="mo" transform="translate(8697.9,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"/></g><g data-mml-node="msubsup" transform="translate(9142.5,0)"><g data-mml-node="mi"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"/></g><g data-mml-node="TeXAtom" transform="translate(518,411.6) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g></g><g data-mml-node="TeXAtom" transform="translate(518,-138.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></g></g></g><g data-mml-node="mo" transform="translate(10260.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g></g><rect width="10849.6" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(11672.6,0) translate(0 -0.5)"><path data-c="5D" d="M5 1677V1750H313V-1249H5V-1176H240V1677H5Z"/></g></g><g data-mml-node="mo" transform="translate(17067.8,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"/></g></g></g></svg></mjx-container></span></p>
<p><span class="math display"><em>σ</em>(<em>x</em>, <em>y</em>) = <em>e</em><em>x</em><em>p</em>(<em>x</em> ⋅ <em>y</em>/<em>τ</em>),</span></p>
<p><span class="math display"><em>τ</em></span>是一个温度超参数。直观地说，这是一个(N+1)的分类问题。</p>
<hr>
<p>什么是对比学习？</p>
<p>可以把对比学习想象成一个教机器“物以类聚，人以群分”的游戏。我们给模型看一张<strong>“基准图片”
(Anchor)</strong>。然后，我们再给它看一张和基准图片<strong>“是同一类”</strong>的图片，我们称之为<strong>“正样本”
(Positive
Sample)</strong>。同时，我们还给它看很多张和基准图片<strong>“不是同一类”</strong>的图片，这些是<strong>“负样本”
(Negative Samples)</strong>。</p>
<p>调整模型，使得在特征空间中，<strong>“基准图片”和“正样本”的特征表示被拉得越来越近</strong>，同时<strong>“基准图片”和所有“负样本”的特征表示被推得越来越远</strong>。通过这个过程，模型就学会了什么东西是本质上相似的，即使它们表面看起来有些许不同。</p>
<hr>
<p>为了减小H和D(H)之间的差距，我们利用了对比学习可以拉近正样本之间距离的这一特性。具体来说：<strong>我们将来自图像H的一个patch和来自图像D(H)的对应patch，定义为一对正样本。</strong>（虽然它俩一个清晰、一个“脏”，但它们的<strong>底层内容是完全一样的</strong>，因为D(H)是同一张H图像在经过人工添加噪声和颜色偏置之后，模拟出的低光照版本）。</p>
<p>作者不是用整张图，而是从图中裁剪出一小块一小块的patch区域。模型的目标是<strong>让干净的Hpatch和有噪声的D(H)patch在特征层面尽可能相似（拉近）</strong>，同时<strong>让我们这个patch（比如我们取的是左眼patch）的特征和数据集中任何其他patch（比如另一张图的鼻子、或者同一张图的嘴巴）的特征尽可能不同（推远）</strong></p>
<p>反之亦然，也就是说这个过程是双向的，作者既把D(H)的patch当做Hpatch的正样本，也把H的patch当做D(H)patch的正样本，来回进行，以加强学习效果。</p>
<p>通过把一张干净图片H 和它的“脏”版本D(H)
的对应部分定义为正样本，并利用对比学习去“拉近”它们，<strong>模型被迫学会忽略那些使图像变“脏”的因素（即噪声和颜色偏差），而去关注图像最本质的内容信息</strong>。最终，模型就能为H
和
D(H)生成几乎一样的特征，提高了二者的特征相似度，从而达到了“缩短二者距离”的目的。</p>
<figure>
<img src="/images/image-20250915212703976.png" alt="image-20250915212703976">
<figcaption aria-hidden="true">image-20250915212703976</figcaption>
</figure>
<p>作者还在H和D(H)本身上引入了单域对比学习，以使特征更好。在实现中，通过将<span class="math display"><em>D</em>(⋅)</span>视为增强的一部分来简化上述四个损失：</p>
<p><span class="math display"><em>L</em><sub><em>H</em> ⇔ <em>D</em>(<em>H</em>)</sub> = <em>L</em><sub><em>q</em></sub>(<em>D</em><sub><em>i</em></sub><sup>*</sup>(<em>H</em>), <em>D</em><sub><em>j</em></sub><sup>*</sup>(<em>H</em>)<sup>+</sup>, <em>D</em><sub><em>k</em></sub><sup>*</sup>(<em>H</em>)<sup>−</sup>),</span></p>
<p>其中<span class="math display"><em>D</em><sup>*</sup>(<em>H</em>)</span>有50%的概率是H，50%的概率是D(H)。训练时，使用动量对比度（MoCo）进行优化。</p>
<h4 id="增强el">增强E(L)</h4>
<p>作者还发现，通过对比学习增强E(L)的特征是有益的：</p>
<p><span class="math display"><em>L</em><sub><em>E</em>(<em>L</em>)↑</sub> = <em>L</em><sub><em>q</em></sub>(<em>E</em>(<em>L</em>), <em>E</em>(<em>L</em>)<sup>+</sup>, <em>E</em>(<em>L</em>)<sup>−</sup>).</span></p>
<h4 id="最终目标">最终目标。</h4>
<p>模型以多任务方式学习。将<span class="math display"><em>L</em><sub><em>d</em><em>e</em><em>t</em></sub></span>表示为检测损失，最终目标是：</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.8ex;" xmlns="http://www.w3.org/2000/svg" width="66.621ex" height="2.37ex" role="img" focusable="false" viewbox="0 -694 29446.7 1047.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"/></g><g data-mml-node="mo" transform="translate(958.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="msub" transform="translate(2014.6,0)"><g data-mml-node="mi"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z"/></g><g data-mml-node="TeXAtom" transform="translate(616,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"/></g><g data-mml-node="mi" transform="translate(520,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"/></g><g data-mml-node="mi" transform="translate(986,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"/></g></g></g><g data-mml-node="msub" transform="translate(3633,0)"><g data-mml-node="mi"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"/></g><g data-mml-node="TeXAtom" transform="translate(714,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"/></g><g data-mml-node="mi" transform="translate(520,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"/></g><g data-mml-node="mi" transform="translate(986,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"/></g></g></g><g data-mml-node="mo" transform="translate(5571.7,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"/></g><g data-mml-node="msub" transform="translate(6571.9,0)"><g data-mml-node="mi"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z"/></g><g data-mml-node="TeXAtom" transform="translate(616,-176.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"/></g><g data-mml-node="mo" transform="translate(764,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(1153,0)"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"/></g><g data-mml-node="mo" transform="translate(1834,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(2223,0)"><path data-c="2194" d="M263 479Q267 501 271 506T288 511Q308 511 308 500Q308 493 303 475Q293 438 278 406T246 352T215 315T185 287T165 270H835Q729 349 696 475Q691 493 691 500Q691 511 711 511Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H165Q167 228 182 216T211 189T244 152T277 96T303 25Q308 7 308 0Q308 -11 288 -11Q281 -11 278 -11T272 -7T267 2T263 21Q245 94 195 151T73 236Q58 242 55 247Q55 254 59 257T73 264Q144 292 194 349T263 479Z"/></g><g data-mml-node="mi" transform="translate(3223,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"/></g></g></g><g data-mml-node="msub" transform="translate(10144.9,0)"><g data-mml-node="mi"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"/></g><g data-mml-node="TeXAtom" transform="translate(714,-176.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"/></g><g data-mml-node="mo" transform="translate(764,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(1153,0)"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"/></g><g data-mml-node="mo" transform="translate(1834,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(2223,0)"><path data-c="2194" d="M263 479Q267 501 271 506T288 511Q308 511 308 500Q308 493 303 475Q293 438 278 406T246 352T215 315T185 287T165 270H835Q729 349 696 475Q691 493 691 500Q691 511 711 511Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H165Q167 228 182 216T211 189T244 152T277 96T303 25Q308 7 308 0Q308 -11 288 -11Q281 -11 278 -11T272 -7T267 2T263 21Q245 94 195 151T73 236Q58 242 55 247Q55 254 59 257T73 264Q144 292 194 349T263 479Z"/></g><g data-mml-node="mi" transform="translate(3223,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"/></g></g></g><g data-mml-node="mspace" transform="translate(13815.8,0)"/><g data-mml-node="mo" transform="translate(14038,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"/></g><g data-mml-node="msub" transform="translate(15038.2,0)"><g data-mml-node="mi"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z"/></g><g data-mml-node="TeXAtom" transform="translate(616,-176.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"/></g><g data-mml-node="mo" transform="translate(888,0)"><path data-c="2194" d="M263 479Q267 501 271 506T288 511Q308 511 308 500Q308 493 303 475Q293 438 278 406T246 352T215 315T185 287T165 270H835Q729 349 696 475Q691 493 691 500Q691 511 711 511Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H165Q167 228 182 216T211 189T244 152T277 96T303 25Q308 7 308 0Q308 -11 288 -11Q281 -11 278 -11T272 -7T267 2T263 21Q245 94 195 151T73 236Q58 242 55 247Q55 254 59 257T73 264Q144 292 194 349T263 479Z"/></g><g data-mml-node="mi" transform="translate(1888,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"/></g><g data-mml-node="mo" transform="translate(2716,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(3105,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"/></g><g data-mml-node="mo" transform="translate(3993,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g></g></g><g data-mml-node="msub" transform="translate(18802.8,0)"><g data-mml-node="mi"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"/></g><g data-mml-node="TeXAtom" transform="translate(714,-176.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"/></g><g data-mml-node="mo" transform="translate(888,0)"><path data-c="2194" d="M263 479Q267 501 271 506T288 511Q308 511 308 500Q308 493 303 475Q293 438 278 406T246 352T215 315T185 287T165 270H835Q729 349 696 475Q691 493 691 500Q691 511 711 511Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H165Q167 228 182 216T211 189T244 152T277 96T303 25Q308 7 308 0Q308 -11 288 -11Q281 -11 278 -11T272 -7T267 2T263 21Q245 94 195 151T73 236Q58 242 55 247Q55 254 59 257T73 264Q144 292 194 349T263 479Z"/></g><g data-mml-node="mi" transform="translate(1888,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"/></g><g data-mml-node="mo" transform="translate(2716,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(3105,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"/></g><g data-mml-node="mo" transform="translate(3993,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g></g></g><g data-mml-node="mo" transform="translate(22887.5,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"/></g><g data-mml-node="msub" transform="translate(23887.8,0)"><g data-mml-node="mi"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z"/></g><g data-mml-node="TeXAtom" transform="translate(616,-176.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"/></g><g data-mml-node="mo" transform="translate(764,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(1153,0)"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"/></g><g data-mml-node="mo" transform="translate(1834,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(2223,0)"><path data-c="2191" d="M27 414Q17 414 17 433Q17 437 17 439T17 444T19 447T20 450T22 452T26 453T30 454T36 456Q80 467 120 494T180 549Q227 607 238 678Q240 694 251 694Q259 694 261 684Q261 677 265 659T284 608T320 549Q340 525 363 507T405 479T440 463T467 455T479 451Q483 447 483 433Q483 413 472 413Q467 413 458 416Q342 448 277 545L270 555V-179Q262 -193 252 -193H250H248Q236 -193 230 -179V555L223 545Q192 499 146 467T70 424T27 414Z"/></g></g></g><g data-mml-node="msub" transform="translate(26479.2,0)"><g data-mml-node="mi"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"/></g><g data-mml-node="TeXAtom" transform="translate(714,-176.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"/></g><g data-mml-node="mo" transform="translate(764,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(1153,0)"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"/></g><g data-mml-node="mo" transform="translate(1834,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(2223,0)"><path data-c="2191" d="M27 414Q17 414 17 433Q17 437 17 439T17 444T19 447T20 450T22 452T26 453T30 454T36 456Q80 467 120 494T180 549Q227 607 238 678Q240 694 251 694Q259 694 261 684Q261 677 265 659T284 608T320 549Q340 525 363 507T405 479T440 463T467 455T479 451Q483 447 483 433Q483 413 472 413Q467 413 458 416Q342 448 277 545L270 555V-179Q262 -193 252 -193H250H248Q236 -193 230 -179V555L223 545Q192 499 146 467T70 424T27 414Z"/></g></g></g><g data-mml-node="mo" transform="translate(29168.7,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"/></g></g></g></svg></mjx-container></span></p>
<p>其中<span class="math display"><em>λ</em><em>s</em></span>是平衡不同损失的超参数。</p>
<h4 id="总结">总结</h4>
<p>一、双向低级自适应就是从亮度、噪声和颜色偏置三个因素分别对低光照图像和正常光照图像进行调整，分别得到E(L)、D(H)。</p>
<p>二、多任务高级适应其实思想好理解，就是通过自监督学习的方式强迫模型分类器去学习正常光图像和低级图像之间的通用特征，就是将<strong>将特征映射到相同的高维子空间</strong>，但是具体怎么多任务就感觉有点复杂了。</p>
<p>因为只有一个分类器，它要能同时处理正常光和低光两种图像，它就必须学会提取一种<strong>通用的、不受光照影响的特征。</strong>模型为了让这同一个分类器能正常工作，就会被迫学习去忽略“亮度”、“噪声”这些属于不同领域的干扰信息，而专注于提取这种最本质的语义特征。最终结果就是，一张亮的人脸和一张暗的人脸，<strong>在模型内部都会被用非常相似的“数学语言”（即映射到特征空间中的邻近位置）来表达。</strong></p>
<p>但是说出来好说，实际做呢，如何让它学会提取一种通用的、不受光照影响的特征，如何保证它能够被迫去学习去忽略亮度、噪声这些干扰信息，如何保证对于不同的输入分类器能正常工作呢，输入两种图像之后，怎么办呢？</p>
<p><strong>损失！通过损失惩罚优化。</strong></p>
<p>多任务，其实就是两块：</p>
<p>1、首先通过跨域的、基于上下文的自监督学习来搭建H与E(L)之间的桥梁，让模型学习到，一张提亮后的低光图像E(L)和一张干净的正常光图像H，虽然一个有噪点和色偏，一个没有，但它们的<strong>核心内容和结构是相同的</strong>。这一步强迫模型学会<strong>忽略真实的噪声和色偏</strong>。</p>
<p>如何去强迫模型学会忽略真实的噪声和色偏呢？</p>
<p>这会让模型学习到提亮后的低光图像和正常光图像的核心内容和结构。H→E(L)</p>
<p>2、然后通过跨域对比学习来搭建H与D(H)之间的桥梁，让模型学习到，一张干净的正常光图像H和我们<strong>亲手把它变脏的图像D(H)是一对正样本</strong>。<strong>因为D(H)是由H直接生成的，内容完全一致，所以这是一个非常强的监督信号。这一步强迫模型学会忽略我们模拟的噪声和色偏。</strong></p>
<p>如何使用这个非常强的监督信号，强迫模型学会忽略我们模拟的噪声和色偏呢？这一步有什么用呢？</p>
<p>这会让模型学习到H与D(H)的核心内容和结构，H→D(H)。</p>
<p>但我还是不明白，H→E(L)和H→D(H)了，这是如何消除H和L之间的高层差距的？</p>
<p>您这个问题提得太棒了！这正是在整个方法论中，最需要“拐个弯”来理解的地方。您已经完全理解了前面的步骤，现在就差这最后一步的逻辑连接了。</p>
<p>确实，模型并没有直接去拉近 <code>H</code> 和
<code>L</code>。因为直接这样做是行不通的，原因如下：</p>
<ul>
<li><strong>没有配对数据</strong>：<code>H</code>
来自一个数据集（比如WIDER FACE），<code>L</code> 来自另一个数据集（DARK
FACE）。你找不到一张 <code>H</code> 和一张
<code>L</code>，它们的内容是完全一样的，只是光照不同。</li>
<li><strong>差异过大</strong>：<code>H</code> 和 <code>L</code>
之间的差异（高层语义鸿沟）太大了，直接让模型去学习，模型会“精神错乱”，不知道该学什么。</li>
</ul>
<p>所以，作者设计了 <code>E(L)</code> 和 <code>D(H)</code>
作为两个至关重要的<strong>“中间人”</strong>或<strong>“桥梁”</strong>，来间接地完成这个任务。</p>
<hr>
<h3 id="核心逻辑训练出一个火眼金睛的特征提取器">核心逻辑：训练出一个“火眼金睛”的特征提取器</h3>
<p>整个过程的<strong>最终目的</strong>，不是真的把图像本身变得一样，而是训练出一个<strong>强大的特征提取器
(Feature
Extractor)</strong>。这个特征提取器要能做到“透过现象看本质”：无论给它一张亮的、暗的、有噪点的、还是颜色失真的图片，只要内容是同一张脸，它提取出的<strong>特征
(features) 就应该是一样的</strong>。</p>
<p>现在我们来看，<code>H→E(L)</code> 和 <code>H→D(H)</code>
这两步是如何帮助我们训练出这个“火眼金睛”的：</p>
<ol type="1">
<li><strong>通过 <code>H</code> 和 <code>E(L)</code>
的对齐，模型学会了什么？</strong>
<ul>
<li><code>E(L)</code> 是真实的低光图像提亮后的结果。它和 <code>H</code>
相比，最大的区别是<strong>保留了真实的相机噪声和颜色偏差</strong>。</li>
<li>当模型被迫认为 <code>Feature(H) ≈ Feature(E(L))</code>
时，它实际上是在学习<strong>“忽略掉这些真实的噪声和颜色偏差”</strong>，并专注于图像的结构和内容。</li>
</ul></li>
<li><strong>通过 <code>H</code> 和 <code>D(H)</code>
的对齐，模型学会了什么？</strong>
<ul>
<li><code>D(H)</code> 是我们用 <code>H</code>
人为制造的“假”低光图像。它和 <code>H</code>
的内容完全一样，只是被我们<strong>加上了模拟的噪声和颜色偏差</strong>。</li>
<li>当模型被迫认为 <code>Feature(H) ≈ Feature(D(H))</code>
时，它实际上是在学习<strong>“忽略掉这些我们模拟出来的噪声和颜色偏差”</strong>。</li>
</ul></li>
</ol>
<h3 id="关键的最后一步融会贯通">关键的最后一步：融会贯通</h3>
<p>现在，我们的特征提取器已经通过上述两项严格的训练，同时掌握了两项关键技能：</p>
<ul>
<li>技能A：能无视<strong>真实世界</strong>的低光伪影 (artifacts)。</li>
<li>技能B：能无视<strong>模拟世界</strong>的低光伪影。</li>
</ul>
<p>当这两项技能结合在一起时，这个特征提取器就变得非常强大和鲁棒了。</p>
<p>此时，我们再把最开始那张<strong>未经任何处理的、原始的低光图像
<code>L</code></strong>
输入到这个训练好的特征提取器中。会发生什么呢？</p>
<ul>
<li>这个特征提取器会说：“哦，这张图 <code>L</code>
很暗、有噪声、还偏色。但是没关系！我在和 <code>E(L)</code>
的比较中，已经学会了如何处理这种真实的噪声和偏色了。在和
<code>D(H)</code>
的比较中，我也巩固了对这些干扰的忽略能力。所以我能‘看穿’这些表面的干扰，直接提取出它最核心的内容特征。”</li>
</ul>
<p>最终的结果就是，这个“火眼金睛”的特征提取器为 <code>L</code>
提取出的特征，会<strong>非常接近</strong>它为那张干净的 <code>H</code>
图像所提取出的特征。</p>
<p><strong>所以，<code>Feature(L) ≈ Feature(H)</code>。</strong></p>
<hr>
<p><strong>总结：</strong></p>
<p>作者并不是直接在 <code>H</code> 和 <code>L</code>
之间建立连接。而是把 <code>H</code>
当作一个<strong>“中心锚点”</strong>，通过 <code>E(L)</code> 和
<code>D(H)</code>
这两个中间人，从两个不同的方向（真实和模拟）训练一个特征提取器，让它学会<strong>忽略一切由低光照引起的干扰</strong>。</p>
<p>一旦这个特征提取器训练好了，它就拥有了直接从原始低光图像
<code>L</code> 中提取出“干净”特征的能力，从而在根本上消除了
<code>H</code> 和 <code>L</code>
之间的高层语义鸿沟。这是一个非常巧妙的“借桥过河”的策略。</p>
<h4 id="参考">参考</h4>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45709330/article/details/116375825">【论文阅读笔记】HLA-Face
Joint High-Low Adaptation for Low Light Face
Detection_hla-face:用于低光人脸检测的高低联合适配-CSDN博客</a></p>

    </div>
    
    
    
    
    
    
    
</div>
 <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2025 - 2025 NWPU-ZAK
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;Zang Ankang
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

      </div>
      
      <transition name="fade">
        <div id="preview" ref="preview" v-show="previewShow">
          <img id="preview-content" ref="previewContent" />
        </div>
      </transition>
      
    </div>
    <script src="/js/main.js"></script>
     



 
    <!-- <script src="/js/random-bg.js"></script> -->
    <script src="https://s4.zstatic.net/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="/js/fireworks.min.js"></script>
    <script src="/js/background.min.js"></script>
    <link rel="stylesheet" href="/css/cursor.min.css" />
    <script src="/js/cursor.min.js"></script>
  </body>
</html>
